<div class="w-full">
  <div class="min-w-full pt-2">
    <%= turbo_frame_tag :card_transactions do %>
      <div class="min-h-screen" data-controller="datatable">
        <div class="flex flex-auto justify-center gap-4 mb-4">
          <%= render "shared/month_year_selector", default_year: Date.current.year, years: @years, active_month_years: [ @active_month_year ], title: @user_card.user_card_name %>
        </div>

        <div class="mb-6 bg-white p-4 rounded-lg shadow-sm">
          <div class="flex gap-3 mb-2">
            <%= select_tag :categories_search, options_for_select(@categories),
                           class: "w-full border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                           include_blank: "All Categories",
                           data: { action: "change->datatable#filterCategory" } %>

            <%= select_tag :entities_search, options_for_select(@entities),
                           class: "w-full border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                           include_blank: "All Entities",
                           data: { action: "change->datatable#filterEntity" } %>
          </div>

          <%= text_field_tag :search, nil,
                             type: :text, placeholder: "Search transactions...",
                             class: "w-full border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",
                             data: { action: "input->datatable#filter" } %>
        </div>


        <%= turbo_frame_tag :month_year_container, data: { user_card_id: @user_card.id } do %>
          <%= turbo_frame_tag "month_year_container_#{@active_month_year}", src: month_year_card_transactions_path(month_year: @active_month_year, user_card_id: @user_card.id) %>
        <% end %>
      </div>

      <%= link_to new_card_transaction_path(format: :turbo_stream),
                  style: "margin: 30px",
                  class: "fixed bottom-0 right-0 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center z-50 active:scale-95 transition-transform",
                  data: { turbo_frame: :center_container, turbo_prefetch: false } do %>
          <svg xmlns="http://www.w3.org/2000/svg" width="62" height="62" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        <% end %>
    <% end %>
  </div>
</div>
